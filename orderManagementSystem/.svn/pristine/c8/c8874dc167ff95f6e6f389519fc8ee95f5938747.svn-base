<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.want.mapper.VisitTractingMapper">

	 <delete id="deleteStoreVisitTarget">  
        DELETE FROM STORE_VISIT_TARGET WHERE DATATIME = #{dataTime}  
	 </delete> 
	 
	 <delete id="deleteStoreVisit">  
        DELETE FROM STORE_VISIT WHERE DATATIME = #{dataTime}  
	 </delete> 
	 
	 <delete id="deleteTagTime">  
        DELETE FROM TAG_TIME WHERE STORE_VISIT_SID IN (SELECT SID FROM STORE_VISIT WHERE DATATIME = #{dataTime}  )
	 </delete> 
	
     <insert id="insertStoreVisitTarget" parameterType="java.util.List">
    	insert	into STORE_VISIT_TARGET (DATATIME,
									REGIONALNAME,
									SALESDEPARTMENTNAME,
									BUSINESSNAME,
									DELEARNAME,
									DELEARCODE,
									DELEARNUMBER,
									COOPERATIONSTATUS,
									TERMINALNAME,
									TERMINALCODE,
									TERMINALADDRESS,
									CONTACT,
									CONTACTPHONE,
									TERMINALSTATUS,
									CREATEDTIME,
									CREATEDUSERNAME,
									CREATEDUSERCODE,
									BELONGER,
									BELONGERCODE,
									ROUTE,
									DISABLEDTIME,
									DISABLEDUSERNAME,
									DISABLEDREASON,
									CHANNELCLASSNAME,
									TERMINALLABEL,
									NEARTERMINALCOUNT,
									TENANTNAME,
									VISITTIME,
									VISITUSER,
									VISITUSERCODE,
									WORKTIME,
									ORDERAMOUNT,
									SHOULDSCORE,
									INSTORETIME,
									INSTOREDISTANCE,
									OUTSTORETIME,
									OUTSTOREDISTANCE,
									SCOREDTIME1,
									SCOREDUSERNAME1,
									SCOREUSERCODE1,
									SCOREUSERROLE1,
									SCORE1,
									INOUTSTORESCORE1,
									DISPLAYSCORE1,
									TEMPTASKSCORE1,
									COMPETINGPRODDISPLAYSCORE1,
									COMPETINGPRODACTIVITYSCORE1,
									COMMUNICATIONSCORE1,
									FEEDBACKSCORE1,
									SCOREDTIME2,
									SCOREDUSERNAME2,
									SCOREUSERCODE2,
									SCOREUSERROLE2,
									SCORE2,
									INOUTSTORESCORE2,
									DISPLAYSCORE2,
									TEMPTASKSCORE2,
									COMPETINGPRODDISPLAYSCORE2,
									COMPETINGPRODACTIVITYSCORE2,
									COMMUNICATIONSCORE2,
									FEEDBACKSCORE2,
									SCOREDTIME3,
									SCOREDUSERNAME3,
									SCOREUSERCODE3,
									SCOREUSERROLE3,
									SCORE3,
									INOUTSTORESCORE3,
									DISPLAYSCORE3,
									TEMPTASKSCORE3,
									COMPETINGPRODDISPLAYSCORE3,
									COMPETINGPRODACTIVITYSCORE3,
									COMMUNICATIONSCORE3,
									FEEDBACKSCORE3,
									SCOREDTIME4,
									SCOREDUSERNAME4,
									SCOREUSERCODE4,
									SCOREUSERROLE4,
									SCORE4,
									INOUTSTORESCORE4,
									DISPLAYSCORE4,
									TEMPTASKSCORE4,
									COMPETINGPRODDISPLAYSCORE4,
									COMPETINGPRODACTIVITYSCORE4,
									COMMUNICATIONSCORE4,
									FEEDBACKSCORE4,
									TARGETTIME,
									TARGETUSER,
									TARGETUSERCODE,
									TARGET,
									TARGETVISITTIME,
									TARGETVISITUSER,
									TARGETVISITUSERCODE,
									TARGETWORKTIME,
									TARGETORDERAMOUNT,
									TARGETSHOULDSCORE,
									TARGETINSTORETIME,
									TARGETINSTOREDISTANCE,
									TARGETOUTSTORETIME,
									TARGETOUTSTOREDISTANCE,
									TARGETVISITTIMEDIFFERENCE,
									SUPERIORSCOREDUSERNAME,
									SUPERIORSCOREUSERCODE,
									SUPERIORSCOREUSERROLE,
									SUPERIORSCORE,
									SUPERIORINOUTSTORESCORE,
									SUPERIORDISPLAYSCORE,
									SUPERIORTEMPTASKSCORE,
									SCOMPETINGPRODDISPLAYSCORE,
									SCOMPETINGPRODACTIVITYSCORE,
									SUPERIORCOMMUNICATIONSCORE,
									SUPERIORFEEDBACKSCORE,
									HEADQUARTERSCOREDUSERNAME,
									HEADQUARTERSCOREUSERCODE,
									HEADQUARTERSCOREUSERROLE,
									HEADQUARTERSCORE,
									HEADQUARTERINOUTSTORESCORE,
									HEADQUARTERDISPLAYSCORE,
									HEADQUARTERTEMPTASKSCORE,
									HQCOMPETINGPRODDISPLAYSCORE,
									HQCOMPETINGPRODACTIVITYSCORE,
									HEADQUARTERCOMMUNICATIONSCORE,
									HEADQUARTERFEEDBACKSCORE,
									POORSCORE,
									SID,
									UPDATE_DATE) 
				SELECT A.* ,SEQ_STORE_VISIT_SID.nextval,sysdate
    					FROM (  
    	<foreach collection="list" item="item" index="index" separator=" UNION ALL ">
					select #{item.dataTime},
					#{item.regionalName},
					#{item.salesDepartMentName},
					#{item.businessName},
					#{item.delearName},
					#{item.delearCode},
					#{item.delearNumber},
					#{item.cooperationStatus},
					#{item.terminalName},
					#{item.terminalCode},
					#{item.terminalAddress},
					#{item.contact},
					#{item.contactPhone},
					#{item.terminalStatus},
					#{item.createdTime},
					#{item.createdUserName},
					#{item.createdUserCode},
					#{item.belonger},
					#{item.belongerCode},
					#{item.route},
					#{item.disabledTime},
					#{item.disabledUserName},
					#{item.disabledReason},
					#{item.channelClassName},
					#{item.terminalLabel},
					#{item.nearTerminalCount},
					#{item.tenantName},
					#{item.visitTime},
					#{item.visitUser},
					#{item.visitUserCode},
					#{item.workTime},
					#{item.orderAmount},
					#{item.shouldScore},
					#{item.inStoreTime},
					#{item.inStoredistance},
					#{item.outStoreTime},
					#{item.outStoredistance},
					#{item.scoredTime1},
					#{item.scoredUserName1},
					#{item.scoreUserCode1},
					#{item.scoreUserRole1},
					#{item.score1},
					#{item.inoutStoreScore1},
					#{item.displayScore1},
					#{item.tempTaskScore1},
					#{item.competingProdDisplayScore1},
					#{item.competingProdActivityScore1},
					#{item.communicationScore1},
					#{item.feedBackScore1},
					#{item.scoredTime2},
					#{item.scoredUserName2},
					#{item.scoreUserCode2},
					#{item.scoreUserRole2},
					#{item.score2},
					#{item.inoutStoreScore2},
					#{item.displayScore2},
					#{item.tempTaskScore2},
					#{item.competingProdDisplayScore2},
					#{item.competingProdActivityScore2},
					#{item.communicationScore2},
					#{item.feedBackScore2},
					#{item.scoredTime3},
					#{item.scoredUserName3},
					#{item.scoreUserCode3},
					#{item.scoreUserRole3},
					#{item.score3},
					#{item.inoutStoreScore3},
					#{item.displayScore3},
					#{item.tempTaskScore3},
					#{item.competingProdDisplayScore3},
					#{item.competingProdActivityScore3},
					#{item.communicationScore3},
					#{item.feedBackScore3},
					#{item.scoredTime4},
					#{item.scoredUserName4},
					#{item.scoreUserCode4},
					#{item.scoreUserRole4},
					#{item.score4},
					#{item.inoutStoreScore4},
					#{item.displayScore4},
					#{item.tempTaskScore4},
					#{item.competingProdDisplayScore4},
					#{item.competingProdActivityScore4},
					#{item.communicationScore4},
					#{item.feedBackScore4},
					#{item.targetTime},
					#{item.targetUser},
					#{item.targetUserCode},
					#{item.target},
					#{item.targetVisitTime},
					#{item.targetVisitUser},
					#{item.targetVisitUserCode},
					#{item.targetWorkTime},
					#{item.targetOrderAmount},
					#{item.targetShouldScore},
					#{item.targetInStoreTime},
					#{item.targetInStoredistance},
					#{item.targetOutStoreTime},
					#{item.targetOutStoredistance},
					#{item.targetVisitTimedifference},
					#{item.superiorScoredUserName},
					#{item.superiorScoreUserCode},
					#{item.superiorScoreUserRole},
					#{item.superiorScore},
					#{item.superiorInoutStoreScore},
					#{item.superiorDisplayScore},
					#{item.superiorTempTaskScore},
					#{item.superiorCompetingProdDisplayScore},
					#{item.superiorCompetingProdActivityScore},
					#{item.superiorCommunicationScore},
					#{item.superiorFeedBackScore},
					#{item.headquarterScoredUserName},
					#{item.headquarterScoreUserCode},
					#{item.headquarterScoreUserRole},
					#{item.headquarterScore},
					#{item.headquarterInoutStoreScore},
					#{item.headquarterDisplayScore},
					#{item.headquarterTempTaskScore},
					#{item.headquarterCompetingProdDisplayScore},
					#{item.headquarterCompetingProdActivityScore},
					#{item.headquarterCommunicationScore},
					#{item.headquarterFeedBackScore},
					#{item.poorScore} from dual
  		</foreach>
  		) A
  	</insert>
  	
  	<insert id="insertStoreVisit" parameterType="com.want.vo.StoreVisit">
    	insert	into STORE_VISIT (DATATIME,
								REGIONALNAME,
								SALESDEPARTMENTNAME,
								BUSINESSNAME,
								DEALERNAME,
								DEALERCODE,
								DEALERNUMBER,
								COOPERATIONSTATUS,
								TERMINALNAME,
								TERMINALCODE,
								TERMINALADDRESS,
								CONTACT,
								CONTACTPHONE,
								TERMINALSTATUS,
								CREATEDTIME,
								CREATEDUSERNAME,
								CREATEDUSERCODE,
								BELONGER,
								BELONGERCODE,
								ROUTE,
								DISABLEDTIME,
								DISABLEDUSERNAME,
								DISABLEDREASON,
								CHANNELCLASSNAME,
								TERMINALLABEL,
								DISPLAYLABELS,
								NEARTERMINALCOUNT,
								SHOULDVISITDATE,
								SHOULDVISITROUTE,
								SHOULDVISITUSER,
								SHOULDVISITUSERCODE,
								VISITTIME,
								VISITUSER,
								VISITUSERCODE,
								WORKTIME,
								ORDERAMOUNT,
								SHOULDSCORE,
								INSTORETIME,
								INSTOREDISTANCE,
								OUTSTORETIME,
								OUTSTOREDISTANCE,
								SCOREDUSERNAME1,
								SCOREDUSERROLE1,
								SCOREDTIME1,
								SCORE1,
								DISPLAYSCORE1,
								INOUTSTORESCORE1,
								COMPETINGPRODDISPLAYSCORE1,
								COMPETINGPRODACTIVITYSCORE1,
								COMMUNICATIONSCORE1,
								FEEDBACKSCORE1,
								TEMPTASKSCORE1,
								SCOREDUSERNAME2,
								SCOREDUSERROLE2,
								SCOREDTIME2,
								SCORE2,
								DISPLAYSCORE2,
								INOUTSTORESCORE2,
								COMPETINGPRODDISPLAYSCORE2,
								COMPETINGPRODACTIVITYSCORE2,
								COMMUNICATIONSCORE2,
								FEEDBACKSCORE2,
								TEMPTASKSCORE2,
								SCOREDUSERNAME3,
								SCOREDUSERROLE3,
								SCOREDTIME3,
								SCORE3,
								DISPLAYSCORE3,
								INOUTSTORESCORE3,
								COMPETINGPRODDISPLAYSCORE3,
								COMPETINGPRODACTIVITYSCORE3,
								COMMUNICATIONSCORE3,
								FEEDBACKSCORE3,
								TEMPTASKSCORE3,
								SCOREDUSERNAME4,
								SCOREDUSERROLE4,
								SCOREDTIME4,
								SCORE4,
								DISPLAYSCORE4,
								INOUTSTORESCORE4,
								COMPETINGPRODDISPLAYSCORE4,
								COMPETINGPRODACTIVITYSCORE4,
								COMMUNICATIONSCORE4,
								FEEDBACKSCORE4,
								TEMPTASKSCORE4,
								FEEDBACK,
								FEEDBACKPHOTO1,
								FEEDBACKPHOTO2,
								FEEDBACKPHOTO3,
								FEEDBACKPHOTO4,
								FEEDBACKPHOTO5,
								FEEDBACKPHOTO6,
								FEEDBACKPHOTO7,
								FEEDBACKPHOTO8,
								FEEDBACKPHOTO9,
								FEEDBACKPHOTO10,
								SID,
								UPDATE_DATE) 
				VALUES( #{storeVisit.dataTime},
					#{storeVisit.regionalName},
					#{storeVisit.salesDepartMentName},
					#{storeVisit.businessName},
					#{storeVisit.dealerName},
					#{storeVisit.dealerCode},
					#{storeVisit.dealerNumber},
					#{storeVisit.cooperationStatus},
					#{storeVisit.terminalName},
					#{storeVisit.terminalCode},
					#{storeVisit.terminalAddress},
					#{storeVisit.contact},
					#{storeVisit.contactPhone},
					#{storeVisit.terminalStatus},
					#{storeVisit.createdTime},
					#{storeVisit.createdUserName},
					#{storeVisit.createdUserCode},
					#{storeVisit.belonger},
					#{storeVisit.belongerCode},
					#{storeVisit.route},
					#{storeVisit.disabledTime},
					#{storeVisit.disabledUserName},
					#{storeVisit.disabledReason},
					#{storeVisit.channelClassName},
					#{storeVisit.terminalLabel},
					#{storeVisit.displayLabels},
					#{storeVisit.nearTerminalCount},
					#{storeVisit.shouldVisitDate},
					#{storeVisit.shouldVisitRoute},
					#{storeVisit.shouldVisitUser},
					#{storeVisit.shouldVisitUserCode},
					#{storeVisit.visitTime},
					#{storeVisit.visitUser},
					#{storeVisit.visitUserCode},
					#{storeVisit.workTime},
					#{storeVisit.orderAmount},
					#{storeVisit.shouldScore},
					#{storeVisit.inStoreTime},
					#{storeVisit.inStoredistance},
					#{storeVisit.outStoreTime},
					#{storeVisit.outStoredistance},
					#{storeVisit.scoredUserName1},
					#{storeVisit.scoredUserRole1},
					#{storeVisit.scoredTime1},
					#{storeVisit.score1},
					#{storeVisit.displayScore1},
					#{storeVisit.inoutStoreScore1},
					#{storeVisit.competingProdDisplayScore1},
					#{storeVisit.competingProdActivityScore1},
					#{storeVisit.communicationScore1},
					#{storeVisit.feedBackScore1},
					#{storeVisit.tempTaskScore1},
					#{storeVisit.scoredUserName2},
					#{storeVisit.scoredUserRole2},
					#{storeVisit.scoredTime2},
					#{storeVisit.score2},
					#{storeVisit.displayScore2},
					#{storeVisit.inoutStoreScore2},
					#{storeVisit.competingProdDisplayScore2},
					#{storeVisit.competingProdActivityScore2},
					#{storeVisit.communicationScore2},
					#{storeVisit.feedBackScore2},
					#{storeVisit.tempTaskScore2},
					#{storeVisit.scoredUserName3},
					#{storeVisit.scoredUserRole3},
					#{storeVisit.scoredTime3},
					#{storeVisit.score3},
					#{storeVisit.displayScore3},
					#{storeVisit.inoutStoreScore3},
					#{storeVisit.competingProdDisplayScore3},
					#{storeVisit.competingProdActivityScore3},
					#{storeVisit.communicationScore3},
					#{storeVisit.feedBackScore3},
					#{storeVisit.tempTaskScore3},
					#{storeVisit.scoredUserName4},
					#{storeVisit.scoredUserRole4},
					#{storeVisit.scoredTime4},
					#{storeVisit.score4},
					#{storeVisit.displayScore4},
					#{storeVisit.inoutStoreScore4},
					#{storeVisit.competingProdDisplayScore4},
					#{storeVisit.competingProdActivityScore4},
					#{storeVisit.communicationScore4},
					#{storeVisit.feedBackScore4},
					#{storeVisit.tempTaskScore4},
					#{storeVisit.feedBack},
					#{storeVisit.feedBackPhoto1},
					#{storeVisit.feedBackPhoto2},
					#{storeVisit.feedBackPhoto3},
					#{storeVisit.feedBackPhoto4},
					#{storeVisit.feedBackPhoto5},
					#{storeVisit.feedBackPhoto6},
					#{storeVisit.feedBackPhoto7},
					#{storeVisit.feedBackPhoto8},
					#{storeVisit.feedBackPhoto9},
					#{storeVisit.feedBackPhoto10},
					#{storeVisit.sid},SYSDATE)
  	</insert>
  
  	<insert id="insertTagTime" parameterType="java.util.List">
    	insert	into TAG_TIME (STORE_VISIT_SID,
								TAG_TIME_TYPE,
								TAG_DATE,
								TAG_NAME) 
				SELECT A.*
    					FROM (  
			<foreach collection="list" item="item" index="index" separator=" UNION ALL "> 
	    			select #{item.storeVisitSid},
					#{item.tagTimeType},
					#{item.date},
					#{item.name} from dual
  		</foreach> 
  		) A
  	</insert>
  
</mapper> 