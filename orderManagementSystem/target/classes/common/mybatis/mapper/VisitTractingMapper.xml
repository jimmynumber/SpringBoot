<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.want.mapper.VisitTractingMapper">

	 <delete id="deleteStoreVisitTarget">  
        DELETE FROM STORE_VISIT_TARGET where DATATIME = #{dataTime}
	 </delete> 
	 
	 <delete id="deleteStoreVisit">  
        DELETE FROM STORE_VISIT WHERE DATATIME in (
           select dataTime from STORE_VISIT_tmp group by dataTime
        )
	 </delete> 
	
	<!-- 1000*60*60*2 -->
	<delete id="clearTagTime" parameterType="String"  timeout="7200" statementType="CALLABLE"  >
	  	{call SALESGROUP2_RC.CLEARTAGTIME_NEW()}
    </delete>
	
     <insert id="insertStoreVisitTarget" parameterType="java.util.List">
    	insert	into STORE_VISIT_TARGET (DATATIME,
									REGIONALNAME,
									SALESDEPARTMENTNAME,
									BUSINESSNAME,
									DELEARNAME,
									DELEARCODE,
									DELEARNUMBER,
									COOPERATIONSTATUS,
									TERMINALNAME,
									TERMINALCODE,
									TERMINALADDRESS,
									CONTACT,
									CONTACTPHONE,
									TERMINALSTATUS,
									CREATEDTIME,
									CREATEDUSERNAME,
									CREATEDUSERCODE,
									BELONGER,
									BELONGERCODE,
									ROUTE,
									DISABLEDTIME,
									DISABLEDUSERNAME,
									DISABLEDREASON,
									CHANNELCLASSNAME,
									TERMINALLABEL,
									NEARTERMINALCOUNT,
									TENANTNAME,
									VISITTIME,
									VISITUSER,
									VISITUSERCODE,
									WORKTIME,
									ORDERAMOUNT,
									SHOULDSCORE,
									INSTORETIME,
									INSTOREDISTANCE,
									OUTSTORETIME,
									OUTSTOREDISTANCE,
									SCOREDTIME1,
									SCOREDUSERNAME1,
									SCOREUSERCODE1,
									SCOREUSERROLE1,
									SCORE1,
									INOUTSTORESCORE1,
									DISPLAYSCORE1,
									TEMPTASKSCORE1,
									COMPETINGPRODDISPLAYSCORE1,
									COMPETINGPRODACTIVITYSCORE1,
									COMMUNICATIONSCORE1,
									FEEDBACKSCORE1,
									SCOREDTIME2,
									SCOREDUSERNAME2,
									SCOREUSERCODE2,
									SCOREUSERROLE2,
									SCORE2,
									INOUTSTORESCORE2,
									DISPLAYSCORE2,
									TEMPTASKSCORE2,
									COMPETINGPRODDISPLAYSCORE2,
									COMPETINGPRODACTIVITYSCORE2,
									COMMUNICATIONSCORE2,
									FEEDBACKSCORE2,
									SCOREDTIME3,
									SCOREDUSERNAME3,
									SCOREUSERCODE3,
									SCOREUSERROLE3,
									SCORE3,
									INOUTSTORESCORE3,
									DISPLAYSCORE3,
									TEMPTASKSCORE3,
									COMPETINGPRODDISPLAYSCORE3,
									COMPETINGPRODACTIVITYSCORE3,
									COMMUNICATIONSCORE3,
									FEEDBACKSCORE3,
									SCOREDTIME4,
									SCOREDUSERNAME4,
									SCOREUSERCODE4,
									SCOREUSERROLE4,
									SCORE4,
									INOUTSTORESCORE4,
									DISPLAYSCORE4,
									TEMPTASKSCORE4,
									COMPETINGPRODDISPLAYSCORE4,
									COMPETINGPRODACTIVITYSCORE4,
									COMMUNICATIONSCORE4,
									FEEDBACKSCORE4,
									TARGETTIME,
									TARGETUSER,
									TARGETUSERCODE,
									TARGET,
									TARGETVISITTIME,
									TARGETVISITUSER,
									TARGETVISITUSERCODE,
									TARGETWORKTIME,
									TARGETORDERAMOUNT,
									TARGETSHOULDSCORE,
									TARGETINSTORETIME,
									TARGETINSTOREDISTANCE,
									TARGETOUTSTORETIME,
									TARGETOUTSTOREDISTANCE,
									TARGETVISITTIMEDIFFERENCE,
									SUPERIORSCOREDUSERNAME,
									SUPERIORSCOREUSERCODE,
									SUPERIORSCOREUSERROLE,
									SUPERIORSCORE,
									SUPERIORINOUTSTORESCORE,
									SUPERIORDISPLAYSCORE,
									SUPERIORTEMPTASKSCORE,
									SCOMPETINGPRODDISPLAYSCORE,
									SCOMPETINGPRODACTIVITYSCORE,
									SUPERIORCOMMUNICATIONSCORE,
									SUPERIORFEEDBACKSCORE,
									HEADQUARTERSCOREDUSERNAME,
									HEADQUARTERSCOREUSERCODE,
									HEADQUARTERSCOREUSERROLE,
									HEADQUARTERSCORE,
									HEADQUARTERINOUTSTORESCORE,
									HEADQUARTERDISPLAYSCORE,
									HEADQUARTERTEMPTASKSCORE,
									HQCOMPETINGPRODDISPLAYSCORE,
									HQCOMPETINGPRODACTIVITYSCORE,
									HEADQUARTERCOMMUNICATIONSCORE,
									HEADQUARTERFEEDBACKSCORE,
									POORSCORE,
									SID,
									UPDATE_DATE) 
				SELECT A.* ,SEQ_STORE_VISIT_SID.nextval,sysdate
    					FROM (  
    	<foreach collection="list" item="item" index="index" separator=" UNION ALL ">
					select #{item.dataTime},
					#{item.regionalName},
					#{item.salesDepartMentName},
					#{item.businessName},
					#{item.delearName},
					#{item.delearCode},
					#{item.delearNumber},
					#{item.cooperationStatus},
					#{item.terminalName},
					#{item.terminalCode},
					#{item.terminalAddress},
					#{item.contact},
					#{item.contactPhone},
					#{item.terminalStatus},
					#{item.createdTime},
					#{item.createdUserName},
					#{item.createdUserCode},
					#{item.belonger},
					#{item.belongerCode},
					#{item.route},
					#{item.disabledTime},
					#{item.disabledUserName},
					#{item.disabledReason},
					#{item.channelClassName},
					#{item.terminalLabel},
					#{item.nearTerminalCount},
					#{item.tenantName},
					#{item.visitTime},
					#{item.visitUser},
					#{item.visitUserCode},
					#{item.workTime},
					#{item.orderAmount},
					#{item.shouldScore},
					#{item.inStoreTime},
					#{item.inStoredistance},
					#{item.outStoreTime},
					#{item.outStoredistance},
					#{item.scoredTime1},
					#{item.scoredUserName1},
					#{item.scoreUserCode1},
					#{item.scoreUserRole1},
					#{item.score1},
					#{item.inoutStoreScore1},
					#{item.displayScore1},
					#{item.tempTaskScore1},
					#{item.competingProdDisplayScore1},
					#{item.competingProdActivityScore1},
					#{item.communicationScore1},
					#{item.feedBackScore1},
					#{item.scoredTime2},
					#{item.scoredUserName2},
					#{item.scoreUserCode2},
					#{item.scoreUserRole2},
					#{item.score2},
					#{item.inoutStoreScore2},
					#{item.displayScore2},
					#{item.tempTaskScore2},
					#{item.competingProdDisplayScore2},
					#{item.competingProdActivityScore2},
					#{item.communicationScore2},
					#{item.feedBackScore2},
					#{item.scoredTime3},
					#{item.scoredUserName3},
					#{item.scoreUserCode3},
					#{item.scoreUserRole3},
					#{item.score3},
					#{item.inoutStoreScore3},
					#{item.displayScore3},
					#{item.tempTaskScore3},
					#{item.competingProdDisplayScore3},
					#{item.competingProdActivityScore3},
					#{item.communicationScore3},
					#{item.feedBackScore3},
					#{item.scoredTime4},
					#{item.scoredUserName4},
					#{item.scoreUserCode4},
					#{item.scoreUserRole4},
					#{item.score4},
					#{item.inoutStoreScore4},
					#{item.displayScore4},
					#{item.tempTaskScore4},
					#{item.competingProdDisplayScore4},
					#{item.competingProdActivityScore4},
					#{item.communicationScore4},
					#{item.feedBackScore4},
					#{item.targetTime},
					#{item.targetUser},
					#{item.targetUserCode},
					#{item.target},
					#{item.targetVisitTime},
					#{item.targetVisitUser},
					#{item.targetVisitUserCode},
					#{item.targetWorkTime},
					#{item.targetOrderAmount},
					#{item.targetShouldScore},
					#{item.targetInStoreTime},
					#{item.targetInStoredistance},
					#{item.targetOutStoreTime},
					#{item.targetOutStoredistance},
					#{item.targetVisitTimedifference},
					#{item.superiorScoredUserName},
					#{item.superiorScoreUserCode},
					#{item.superiorScoreUserRole},
					#{item.superiorScore},
					#{item.superiorInoutStoreScore},
					#{item.superiorDisplayScore},
					#{item.superiorTempTaskScore},
					#{item.superiorCompetingProdDisplayScore},
					#{item.superiorCompetingProdActivityScore},
					#{item.superiorCommunicationScore},
					#{item.superiorFeedBackScore},
					#{item.headquarterScoredUserName},
					#{item.headquarterScoreUserCode},
					#{item.headquarterScoreUserRole},
					#{item.headquarterScore},
					#{item.headquarterInoutStoreScore},
					#{item.headquarterDisplayScore},
					#{item.headquarterTempTaskScore},
					#{item.headquarterCompetingProdDisplayScore},
					#{item.headquarterCompetingProdActivityScore},
					#{item.headquarterCommunicationScore},
					#{item.headquarterFeedBackScore},
					#{item.poorScore} from dual
  		</foreach>
  		) A
  	</insert>
  	
  	<insert id="insertStoreVisit" parameterType="java.util.List">
    	insert	into STORE_VISIT (DATATIME,
								REGIONALNAME,
								SALESDEPARTMENTNAME,
								BUSINESSNAME,
								DEALERNAME,
								DEALERCODE,
								DEALERNUMBER,
								COOPERATIONSTATUS,
								TERMINALNAME,
								TERMINALCODE,
								TERMINALADDRESS,
								CONTACT,
								CONTACTPHONE,
								TERMINALSTATUS,
								CREATEDTIME,
								CREATEDUSERNAME,
								CREATEDUSERCODE,
								BELONGER,
								BELONGERCODE,
								ROUTE,
								DISABLEDTIME,
								DISABLEDUSERNAME,
								DISABLEDREASON,
								CHANNELCLASSNAME,
								TERMINALLABEL,
								DISPLAYLABELS,
								NEARTERMINALCOUNT,
								SHOULDVISITDATE,
								SHOULDVISITROUTE,
								SHOULDVISITUSER,
								SHOULDVISITUSERCODE,
								VISITTIME,
								VISITUSER,
								VISITUSERCODE,
								WORKTIME,
								ORDERAMOUNT,
								SHOULDSCORE,
								INSTORETIME,
								INSTOREDISTANCE,
								OUTSTORETIME,
								OUTSTOREDISTANCE,
								SCOREDUSERNAME1,
								SCOREDUSERROLE1,
								SCOREDTIME1,
								SCORE1,
								DISPLAYSCORE1,
								INOUTSTORESCORE1,
								COMPETINGPRODDISPLAYSCORE1,
								COMPETINGPRODACTIVITYSCORE1,
								COMMUNICATIONSCORE1,
								FEEDBACKSCORE1,
								TEMPTASKSCORE1,
								SCOREDUSERNAME2,
								SCOREDUSERROLE2,
								SCOREDTIME2,
								SCORE2,
								DISPLAYSCORE2,
								INOUTSTORESCORE2,
								COMPETINGPRODDISPLAYSCORE2,
								COMPETINGPRODACTIVITYSCORE2,
								COMMUNICATIONSCORE2,
								FEEDBACKSCORE2,
								TEMPTASKSCORE2,
								SCOREDUSERNAME3,
								SCOREDUSERROLE3,
								SCOREDTIME3,
								SCORE3,
								DISPLAYSCORE3,
								INOUTSTORESCORE3,
								COMPETINGPRODDISPLAYSCORE3,
								COMPETINGPRODACTIVITYSCORE3,
								COMMUNICATIONSCORE3,
								FEEDBACKSCORE3,
								TEMPTASKSCORE3,
								SCOREDUSERNAME4,
								SCOREDUSERROLE4,
								SCOREDTIME4,
								SCORE4,
								DISPLAYSCORE4,
								INOUTSTORESCORE4,
								COMPETINGPRODDISPLAYSCORE4,
								COMPETINGPRODACTIVITYSCORE4,
								COMMUNICATIONSCORE4,
								FEEDBACKSCORE4,
								TEMPTASKSCORE4,
								FEEDBACK,
								FEEDBACKPHOTO1,
								FEEDBACKPHOTO2,
								FEEDBACKPHOTO3,
								FEEDBACKPHOTO4,
								FEEDBACKPHOTO5,
								FEEDBACKPHOTO6,
								FEEDBACKPHOTO7,
								FEEDBACKPHOTO8,
								FEEDBACKPHOTO9,
								FEEDBACKPHOTO10,
								SID,
								UPDATE_DATE) 
		SELECT A.* FROM (  
    	<foreach collection="list" item="item" index="index" separator=" UNION ALL ">
				select #{item.dataTime},
					#{item.regionalName},
					#{item.salesDepartMentName},
					#{item.businessName},
					#{item.dealerName},
					#{item.dealerCode},
					#{item.dealerNumber},
					#{item.cooperationStatus},
					#{item.terminalName},
					#{item.terminalCode},
					#{item.terminalAddress},
					#{item.contact},
					#{item.contactPhone},
					#{item.terminalStatus},
					#{item.createdTime},
					#{item.createdUserName},
					#{item.createdUserCode},
					#{item.belonger},
					#{item.belongerCode},
					#{item.route},
					#{item.disabledTime},
					#{item.disabledUserName},
					#{item.disabledReason},
					#{item.channelClassName},
					#{item.terminalLabel},
					#{item.displayLabels},
					#{item.nearTerminalCount},
					#{item.shouldVisitDate},
					#{item.shouldVisitRoute},
					#{item.shouldVisitUser},
					#{item.shouldVisitUserCode},
					#{item.visitTime},
					#{item.visitUser},
					#{item.visitUserCode},
					#{item.workTime},
					#{item.orderAmount},
					#{item.shouldScore},
					#{item.inStoreTime},
					#{item.inStoredistance},
					#{item.outStoreTime},
					#{item.outStoredistance},
					#{item.scoredUserName1},
					#{item.scoredUserRole1},
					#{item.scoredTime1},
					#{item.score1},
					#{item.displayScore1},
					#{item.inoutStoreScore1},
					#{item.competingProdDisplayScore1},
					#{item.competingProdActivityScore1},
					#{item.communicationScore1},
					#{item.feedBackScore1},
					#{item.tempTaskScore1},
					#{item.scoredUserName2},
					#{item.scoredUserRole2},
					#{item.scoredTime2},
					#{item.score2},
					#{item.displayScore2},
					#{item.inoutStoreScore2},
					#{item.competingProdDisplayScore2},
					#{item.competingProdActivityScore2},
					#{item.communicationScore2},
					#{item.feedBackScore2},
					#{item.tempTaskScore2},
					#{item.scoredUserName3},
					#{item.scoredUserRole3},
					#{item.scoredTime3},
					#{item.score3},
					#{item.displayScore3},
					#{item.inoutStoreScore3},
					#{item.competingProdDisplayScore3},
					#{item.competingProdActivityScore3},
					#{item.communicationScore3},
					#{item.feedBackScore3},
					#{item.tempTaskScore3},
					#{item.scoredUserName4},
					#{item.scoredUserRole4},
					#{item.scoredTime4},
					#{item.score4},
					#{item.displayScore4},
					#{item.inoutStoreScore4},
					#{item.competingProdDisplayScore4},
					#{item.competingProdActivityScore4},
					#{item.communicationScore4},
					#{item.feedBackScore4},
					#{item.tempTaskScore4},
					#{item.feedBack},
					#{item.feedBackPhoto1},
					#{item.feedBackPhoto2},
					#{item.feedBackPhoto3},
					#{item.feedBackPhoto4},
					#{item.feedBackPhoto5},
					#{item.feedBackPhoto6},
					#{item.feedBackPhoto7},
					#{item.feedBackPhoto8},
					#{item.feedBackPhoto9},
					#{item.feedBackPhoto10},
					#{item.sid},SYSDATE from dual
					</foreach>
  		) A
  	</insert>
  
  	<insert id="insertTagTime" parameterType="java.util.List">
    	insert	into TAG_TIME (STORE_VISIT_SID,
								TAG_TIME_TYPE,
								TAG_DATE,
								TAG_NAME,
								DATATIME) 
				SELECT A.*
    					FROM (  
			<foreach collection="list" item="item" index="index" separator=" UNION ALL "> 
	    			select #{item.storeVisitSid},
					#{item.tagTimeType},
					#{item.date},
					#{item.name},
					#{item.dataTime} from dual
  		</foreach> 
  		) A
  	</insert>
  	
  	<delete id="truncateStoreVisitTmp">  
        truncate table  STORE_VISIT_TMP
	 </delete> 
  	<delete id="truncateTagTimeTmp">  
        truncate table  TAG_TIME_TMP
	</delete> 
	
	<insert id="mergerStoreVisit" timeout="7200">
	    insert into STORE_VISIT(DATATIME,
								REGIONALNAME,
								SALESDEPARTMENTNAME,
								BUSINESSNAME,
								DEALERNAME,
								DEALERCODE,
								DEALERNUMBER,
								COOPERATIONSTATUS,
								TERMINALNAME,
								TERMINALCODE,
								TERMINALADDRESS,
								CONTACT,
								CONTACTPHONE,
								TERMINALSTATUS,
								CREATEDTIME,
								CREATEDUSERNAME,
								CREATEDUSERCODE,
								BELONGER,
								BELONGERCODE,
								ROUTE,
								DISABLEDTIME,
								DISABLEDUSERNAME,
								DISABLEDREASON,
								CHANNELCLASSNAME,
								TERMINALLABEL,
								DISPLAYLABELS,
								NEARTERMINALCOUNT,
								SHOULDVISITDATE,
								SHOULDVISITROUTE,
								SHOULDVISITUSER,
								SHOULDVISITUSERCODE,
								VISITTIME,
								VISITUSER,
								VISITUSERCODE,
								WORKTIME,
								ORDERAMOUNT,
								SHOULDSCORE,
								INSTORETIME,
								INSTOREDISTANCE,
								OUTSTORETIME,
								OUTSTOREDISTANCE,
								SCOREDUSERNAME1,
								SCOREDUSERROLE1,
								SCOREDTIME1,
								SCORE1,
								DISPLAYSCORE1,
								INOUTSTORESCORE1,
								COMPETINGPRODDISPLAYSCORE1,
								COMPETINGPRODACTIVITYSCORE1,
								COMMUNICATIONSCORE1,
								FEEDBACKSCORE1,
								TEMPTASKSCORE1,
								SCOREDUSERNAME2,
								SCOREDUSERROLE2,
								SCOREDTIME2,
								SCORE2,
								DISPLAYSCORE2,
								INOUTSTORESCORE2,
								COMPETINGPRODDISPLAYSCORE2,
								COMPETINGPRODACTIVITYSCORE2,
								COMMUNICATIONSCORE2,
								FEEDBACKSCORE2,
								TEMPTASKSCORE2,
								SCOREDUSERNAME3,
								SCOREDUSERROLE3,
								SCOREDTIME3,
								SCORE3,
								DISPLAYSCORE3,
								INOUTSTORESCORE3,
								COMPETINGPRODDISPLAYSCORE3,
								COMPETINGPRODACTIVITYSCORE3,
								COMMUNICATIONSCORE3,
								FEEDBACKSCORE3,
								TEMPTASKSCORE3,
								SCOREDUSERNAME4,
								SCOREDUSERROLE4,
								SCOREDTIME4,
								SCORE4,
								DISPLAYSCORE4,
								INOUTSTORESCORE4,
								COMPETINGPRODDISPLAYSCORE4,
								COMPETINGPRODACTIVITYSCORE4,
								COMMUNICATIONSCORE4,
								FEEDBACKSCORE4,
								TEMPTASKSCORE4,
								FEEDBACK,
								FEEDBACKPHOTO1,
								FEEDBACKPHOTO2,
								FEEDBACKPHOTO3,
								FEEDBACKPHOTO4,
								FEEDBACKPHOTO5,
								FEEDBACKPHOTO6,
								FEEDBACKPHOTO7,
								FEEDBACKPHOTO8,
								FEEDBACKPHOTO9,
								FEEDBACKPHOTO10,
								SID,
								UPDATE_DATE
	    )
	    select DATATIME,
			REGIONALNAME,
			SALESDEPARTMENTNAME,
			BUSINESSNAME,
			DEALERNAME,
			DEALERCODE,
			DEALERNUMBER,
			COOPERATIONSTATUS,
			TERMINALNAME,
			TERMINALCODE,
			TERMINALADDRESS,
			CONTACT,
			CONTACTPHONE,
			TERMINALSTATUS,
			CREATEDTIME,
			CREATEDUSERNAME,
			CREATEDUSERCODE,
			BELONGER,
			BELONGERCODE,
			ROUTE,
			DISABLEDTIME,
			DISABLEDUSERNAME,
			DISABLEDREASON,
			CHANNELCLASSNAME,
			TERMINALLABEL,
			DISPLAYLABELS,
			NEARTERMINALCOUNT,
			SHOULDVISITDATE,
			SHOULDVISITROUTE,
			SHOULDVISITUSER,
			SHOULDVISITUSERCODE,
			VISITTIME,
			VISITUSER,
			VISITUSERCODE,
			WORKTIME,
			ORDERAMOUNT,
			SHOULDSCORE,
			INSTORETIME,
			INSTOREDISTANCE,
			OUTSTORETIME,
			OUTSTOREDISTANCE,
			SCOREDUSERNAME1,
			SCOREDUSERROLE1,
			SCOREDTIME1,
			SCORE1,
			DISPLAYSCORE1,
			INOUTSTORESCORE1,
			COMPETINGPRODDISPLAYSCORE1,
			COMPETINGPRODACTIVITYSCORE1,
			COMMUNICATIONSCORE1,
			FEEDBACKSCORE1,
			TEMPTASKSCORE1,
			SCOREDUSERNAME2,
			SCOREDUSERROLE2,
			SCOREDTIME2,
			SCORE2,
			DISPLAYSCORE2,
			INOUTSTORESCORE2,
			COMPETINGPRODDISPLAYSCORE2,
			COMPETINGPRODACTIVITYSCORE2,
			COMMUNICATIONSCORE2,
			FEEDBACKSCORE2,
			TEMPTASKSCORE2,
			SCOREDUSERNAME3,
			SCOREDUSERROLE3,
			SCOREDTIME3,
			SCORE3,
			DISPLAYSCORE3,
			INOUTSTORESCORE3,
			COMPETINGPRODDISPLAYSCORE3,
			COMPETINGPRODACTIVITYSCORE3,
			COMMUNICATIONSCORE3,
			FEEDBACKSCORE3,
			TEMPTASKSCORE3,
			SCOREDUSERNAME4,
			SCOREDUSERROLE4,
			SCOREDTIME4,
			SCORE4,
			DISPLAYSCORE4,
			INOUTSTORESCORE4,
			COMPETINGPRODDISPLAYSCORE4,
			COMPETINGPRODACTIVITYSCORE4,
			COMMUNICATIONSCORE4,
			FEEDBACKSCORE4,
			TEMPTASKSCORE4,
			FEEDBACK,
			FEEDBACKPHOTO1,
			FEEDBACKPHOTO2,
			FEEDBACKPHOTO3,
			FEEDBACKPHOTO4,
			FEEDBACKPHOTO5,
			FEEDBACKPHOTO6,
			FEEDBACKPHOTO7,
			FEEDBACKPHOTO8,
			FEEDBACKPHOTO9,
			FEEDBACKPHOTO10,
			SID,
			UPDATE_DATE 
			from STORE_VISIT_TMP
	</insert>
	
	<insert id="mergerTagTime" timeout="7200" >
	    insert into TAG_TIME(STORE_VISIT_SID,
								TAG_TIME_TYPE,
								TAG_DATE,
								TAG_NAME,
								DATATIME	    
	    ) select STORE_VISIT_SID,
				 TAG_TIME_TYPE,
				 TAG_DATE,
				 TAG_NAME,
				 DATATIME from TAG_TIME_TMP
	</insert>
	
	<insert id="insertTagTimeTmp" parameterType="java.util.List">
    	insert	into TAG_TIME_TMP (STORE_VISIT_SID,
								TAG_TIME_TYPE,
								TAG_DATE,
								TAG_NAME,
								DATATIME) 
				SELECT A.*
    					FROM (  
			<foreach collection="list" item="item" index="index" separator=" UNION ALL "> 
	    			select #{item.storeVisitSid},
					#{item.tagTimeType},
					#{item.date},
					#{item.name},
					to_date(#{item.dataTime},'YYYY-MM') from dual
  		</foreach> 
  		) A
  	</insert>
  	
  	<insert id="insertStoreVisitTmp" parameterType="java.util.List">
    	insert	into STORE_VISIT_TMP (DATATIME,
								REGIONALNAME,
								SALESDEPARTMENTNAME,
								BUSINESSNAME,
								DEALERNAME,
								DEALERCODE,
								DEALERNUMBER,
								COOPERATIONSTATUS,
								TERMINALNAME,
								TERMINALCODE,
								TERMINALADDRESS,
								CONTACT,
								CONTACTPHONE,
								TERMINALSTATUS,
								CREATEDTIME,
								CREATEDUSERNAME,
								CREATEDUSERCODE,
								BELONGER,
								BELONGERCODE,
								ROUTE,
								DISABLEDTIME,
								DISABLEDUSERNAME,
								DISABLEDREASON,
								CHANNELCLASSNAME,
								TERMINALLABEL,
								DISPLAYLABELS,
								NEARTERMINALCOUNT,
								SHOULDVISITDATE,
								SHOULDVISITROUTE,
								SHOULDVISITUSER,
								SHOULDVISITUSERCODE,
								VISITTIME,
								VISITUSER,
								VISITUSERCODE,
								WORKTIME,
								ORDERAMOUNT,
								SHOULDSCORE,
								INSTORETIME,
								INSTOREDISTANCE,
								OUTSTORETIME,
								OUTSTOREDISTANCE,
								SCOREDUSERNAME1,
								SCOREDUSERROLE1,
								SCOREDTIME1,
								SCORE1,
								DISPLAYSCORE1,
								INOUTSTORESCORE1,
								COMPETINGPRODDISPLAYSCORE1,
								COMPETINGPRODACTIVITYSCORE1,
								COMMUNICATIONSCORE1,
								FEEDBACKSCORE1,
								TEMPTASKSCORE1,
								SCOREDUSERNAME2,
								SCOREDUSERROLE2,
								SCOREDTIME2,
								SCORE2,
								DISPLAYSCORE2,
								INOUTSTORESCORE2,
								COMPETINGPRODDISPLAYSCORE2,
								COMPETINGPRODACTIVITYSCORE2,
								COMMUNICATIONSCORE2,
								FEEDBACKSCORE2,
								TEMPTASKSCORE2,
								SCOREDUSERNAME3,
								SCOREDUSERROLE3,
								SCOREDTIME3,
								SCORE3,
								DISPLAYSCORE3,
								INOUTSTORESCORE3,
								COMPETINGPRODDISPLAYSCORE3,
								COMPETINGPRODACTIVITYSCORE3,
								COMMUNICATIONSCORE3,
								FEEDBACKSCORE3,
								TEMPTASKSCORE3,
								SCOREDUSERNAME4,
								SCOREDUSERROLE4,
								SCOREDTIME4,
								SCORE4,
								DISPLAYSCORE4,
								INOUTSTORESCORE4,
								COMPETINGPRODDISPLAYSCORE4,
								COMPETINGPRODACTIVITYSCORE4,
								COMMUNICATIONSCORE4,
								FEEDBACKSCORE4,
								TEMPTASKSCORE4,
								FEEDBACK,
								FEEDBACKPHOTO1,
								FEEDBACKPHOTO2,
								FEEDBACKPHOTO3,
								FEEDBACKPHOTO4,
								FEEDBACKPHOTO5,
								FEEDBACKPHOTO6,
								FEEDBACKPHOTO7,
								FEEDBACKPHOTO8,
								FEEDBACKPHOTO9,
								FEEDBACKPHOTO10,
								SID,
								UPDATE_DATE) 
		SELECT A.* FROM (  
    	<foreach collection="list" item="item" index="index" separator=" UNION ALL ">
				select to_date(#{item.dataTime},'YYYY-MM'),
					#{item.regionalName},
					#{item.salesDepartMentName},
					#{item.businessName},
					#{item.dealerName},
					#{item.dealerCode},
					#{item.dealerNumber},
					#{item.cooperationStatus},
					#{item.terminalName},
					#{item.terminalCode},
					#{item.terminalAddress},
					#{item.contact},
					#{item.contactPhone},
					#{item.terminalStatus},
					#{item.createdTime},
					#{item.createdUserName},
					#{item.createdUserCode},
					#{item.belonger},
					#{item.belongerCode},
					#{item.route},
					#{item.disabledTime},
					#{item.disabledUserName},
					#{item.disabledReason},
					#{item.channelClassName},
					#{item.terminalLabel},
					#{item.displayLabels},
					#{item.nearTerminalCount},
					#{item.shouldVisitDate},
					#{item.shouldVisitRoute},
					#{item.shouldVisitUser},
					#{item.shouldVisitUserCode},
					#{item.visitTime},
					#{item.visitUser},
					#{item.visitUserCode},
					#{item.workTime},
					#{item.orderAmount},
					#{item.shouldScore},
					#{item.inStoreTime},
					#{item.inStoredistance},
					#{item.outStoreTime},
					#{item.outStoredistance},
					#{item.scoredUserName1},
					#{item.scoredUserRole1},
					#{item.scoredTime1},
					#{item.score1},
					#{item.displayScore1},
					#{item.inoutStoreScore1},
					#{item.competingProdDisplayScore1},
					#{item.competingProdActivityScore1},
					#{item.communicationScore1},
					#{item.feedBackScore1},
					#{item.tempTaskScore1},
					#{item.scoredUserName2},
					#{item.scoredUserRole2},
					#{item.scoredTime2},
					#{item.score2},
					#{item.displayScore2},
					#{item.inoutStoreScore2},
					#{item.competingProdDisplayScore2},
					#{item.competingProdActivityScore2},
					#{item.communicationScore2},
					#{item.feedBackScore2},
					#{item.tempTaskScore2},
					#{item.scoredUserName3},
					#{item.scoredUserRole3},
					#{item.scoredTime3},
					#{item.score3},
					#{item.displayScore3},
					#{item.inoutStoreScore3},
					#{item.competingProdDisplayScore3},
					#{item.competingProdActivityScore3},
					#{item.communicationScore3},
					#{item.feedBackScore3},
					#{item.tempTaskScore3},
					#{item.scoredUserName4},
					#{item.scoredUserRole4},
					#{item.scoredTime4},
					#{item.score4},
					#{item.displayScore4},
					#{item.inoutStoreScore4},
					#{item.competingProdDisplayScore4},
					#{item.competingProdActivityScore4},
					#{item.communicationScore4},
					#{item.feedBackScore4},
					#{item.tempTaskScore4},
					#{item.feedBack},
					#{item.feedBackPhoto1},
					#{item.feedBackPhoto2},
					#{item.feedBackPhoto3},
					#{item.feedBackPhoto4},
					#{item.feedBackPhoto5},
					#{item.feedBackPhoto6},
					#{item.feedBackPhoto7},
					#{item.feedBackPhoto8},
					#{item.feedBackPhoto9},
					#{item.feedBackPhoto10},
					#{item.sid},SYSDATE from dual
					</foreach>
  		) A
  	</insert>
	
</mapper> 